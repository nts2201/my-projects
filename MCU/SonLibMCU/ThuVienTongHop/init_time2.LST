C51 COMPILER V9.01   INIT_TIME2                                                            05/29/2011 16:28:04 PAGE 1   


C51 COMPILER V9.01, COMPILATION OF MODULE INIT_TIME2
OBJECT MODULE PLACED IN init_time2.OBJ
COMPILER INVOKED BY: C:\Keil\C51\BIN\C51.EXE init_time2.c BROWSE DEBUG OBJECTEXTEND

line level    source

   1          #include <REGX52.H>
   2          #include  <allfuntion.h>
*** ERROR C231 IN LINE 11 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P0': redefinition
*** ERROR C231 IN LINE 12 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'SP': redefinition
*** ERROR C231 IN LINE 13 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'DPL': redefinition
*** ERROR C231 IN LINE 14 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'DPH': redefinition
*** ERROR C231 IN LINE 17 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'PCON': redefinition
*** ERROR C231 IN LINE 18 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'TCON': redefinition
*** ERROR C231 IN LINE 19 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'TMOD': redefinition
*** ERROR C231 IN LINE 20 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'TL0': redefinition
*** ERROR C231 IN LINE 21 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'TL1': redefinition
*** ERROR C231 IN LINE 22 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'TH0': redefinition
*** ERROR C231 IN LINE 23 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'TH1': redefinition
*** ERROR C231 IN LINE 24 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'AUXR': redefinition
*** ERROR C231 IN LINE 25 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P1': redefinition
*** ERROR C231 IN LINE 26 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'SCON': redefinition
*** ERROR C231 IN LINE 27 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'SBUF': redefinition
*** ERROR C231 IN LINE 28 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P2': redefinition
*** ERROR C231 IN LINE 30 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'IE': redefinition
*** ERROR C231 IN LINE 33 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P3': redefinition
*** ERROR C231 IN LINE 40 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'T2CON': redefinition
*** ERROR C231 IN LINE 41 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'T2MOD': redefinition
*** ERROR C231 IN LINE 42 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'RCAP2L': redefinition
*** ERROR C231 IN LINE 43 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'RCAP2H': redefinition
*** ERROR C231 IN LINE 44 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'TL2': redefinition
*** ERROR C231 IN LINE 45 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'TH2': redefinition
*** ERROR C231 IN LINE 46 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'PSW': redefinition
*** ERROR C231 IN LINE 55 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'ACC': redefinition
*** ERROR C231 IN LINE 63 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'B': redefinition
*** ERROR C231 IN LINE 72 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'WDTRST': redefinition
*** ERROR C231 IN LINE 76 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P0_0': redefinition
*** ERROR C231 IN LINE 77 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P0_1': redefinition
*** ERROR C231 IN LINE 78 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P0_2': redefinition
*** ERROR C231 IN LINE 79 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P0_3': redefinition
*** ERROR C231 IN LINE 80 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P0_4': redefinition
*** ERROR C231 IN LINE 81 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P0_5': redefinition
*** ERROR C231 IN LINE 82 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P0_6': redefinition
*** ERROR C231 IN LINE 83 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P0_7': redefinition
*** ERROR C231 IN LINE 89 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P1_0': redefinition
*** ERROR C231 IN LINE 90 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P1_1': redefinition
*** ERROR C231 IN LINE 91 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P1_2': redefinition
*** ERROR C231 IN LINE 92 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P1_3': redefinition
*** ERROR C231 IN LINE 93 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P1_4': redefinition
*** ERROR C231 IN LINE 94 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P1_5': redefinition
*** ERROR C231 IN LINE 95 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P1_6': redefinition
*** ERROR C231 IN LINE 96 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P1_7': redefinition
*** ERROR C231 IN LINE 97 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'T2': redefinition
*** ERROR C231 IN LINE 101 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P2_0': redefinition
*** ERROR C231 IN LINE 102 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P2_1': redefinition
*** ERROR C231 IN LINE 103 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P2_2': redefinition
*** ERROR C231 IN LINE 104 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P2_3': redefinition
*** ERROR C231 IN LINE 105 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P2_4': redefinition
*** ERROR C231 IN LINE 106 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P2_5': redefinition
*** ERROR C231 IN LINE 107 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P2_6': redefinition
*** ERROR C231 IN LINE 108 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P2_7': redefinition
C51 COMPILER V9.01   INIT_TIME2                                                            05/29/2011 16:28:04 PAGE 2   

*** ERROR C231 IN LINE 112 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P3_0': redefinition
*** ERROR C231 IN LINE 113 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P3_1': redefinition
*** ERROR C231 IN LINE 114 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P3_2': redefinition
*** ERROR C231 IN LINE 115 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P3_3': redefinition
*** ERROR C231 IN LINE 116 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P3_4': redefinition
*** ERROR C231 IN LINE 117 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P3_5': redefinition
*** ERROR C231 IN LINE 118 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P3_6': redefinition
*** ERROR C231 IN LINE 119 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P3_7': redefinition
*** WARNING C317 IN LINE 144 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: attempt to redefine macro 'POF_'
*** WARNING C317 IN LINE 149 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: attempt to redefine macro 'disale_'
*** WARNING C317 IN LINE 150 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: attempt to redefine macro 'disrto_'
*** WARNING C317 IN LINE 151 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: attempt to redefine macro 'wdidle_'
*** ERROR C231 IN LINE 164 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'IT0': redefinition
*** ERROR C231 IN LINE 165 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'IE0': redefinition
*** ERROR C231 IN LINE 166 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'IT1': redefinition
*** ERROR C231 IN LINE 167 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'IE1': redefinition
*** ERROR C231 IN LINE 168 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'TR0': redefinition
*** ERROR C231 IN LINE 169 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'TF0': redefinition
*** ERROR C231 IN LINE 170 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'TR1': redefinition
*** ERROR C231 IN LINE 171 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'TF1': redefinition
*** ERROR C231 IN LINE 174 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'T2EX': redefinition
*** ERROR C231 IN LINE 183 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'RI': redefinition
*** ERROR C231 IN LINE 184 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'TI': redefinition
*** ERROR C231 IN LINE 185 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'RB8': redefinition
*** ERROR C231 IN LINE 186 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'TB8': redefinition
*** ERROR C231 IN LINE 187 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'REN': redefinition
*** ERROR C231 IN LINE 188 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'SM2': redefinition
*** ERROR C231 IN LINE 189 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'SM1': redefinition
*** ERROR C231 IN LINE 190 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'SM0': redefinition
*** ERROR C231 IN LINE 194 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'EX0': redefinition
*** ERROR C231 IN LINE 195 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'ET0': redefinition
*** ERROR C231 IN LINE 196 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'EX1': redefinition
*** ERROR C231 IN LINE 197 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'ET1': redefinition
*** ERROR C231 IN LINE 199 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'ES': redefinition
*** ERROR C231 IN LINE 200 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'ET2': redefinition
*** ERROR C231 IN LINE 202 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'EA': redefinition
*** ERROR C231 IN LINE 207 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'INT0': redefinition
*** ERROR C231 IN LINE 208 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'INT1': redefinition
*** ERROR C231 IN LINE 209 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'T0': redefinition
*** ERROR C231 IN LINE 210 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'T1': redefinition
*** ERROR C231 IN LINE 211 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'WR': redefinition
*** ERROR C231 IN LINE 212 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'RD': redefinition
*** ERROR C231 IN LINE 215 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'PX0': redefinition
*** ERROR C231 IN LINE 216 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'PT0': redefinition
*** ERROR C231 IN LINE 217 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'PX1': redefinition
*** ERROR C231 IN LINE 218 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'PT1': redefinition
*** ERROR C231 IN LINE 219 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'PS': redefinition
*** ERROR C231 IN LINE 220 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'PT2': redefinition
*** ERROR C231 IN LINE 233 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'C_T2': redefinition
*** ERROR C231 IN LINE 234 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'TR2': redefinition
*** ERROR C231 IN LINE 235 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'EXEN2': redefinition
*** ERROR C231 IN LINE 236 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'TCLK': redefinition
*** ERROR C231 IN LINE 237 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'RCLK': redefinition
*** ERROR C231 IN LINE 238 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'EXF2': redefinition
*** ERROR C231 IN LINE 239 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'TF2': redefinition
*** ERROR C231 IN LINE 247 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'P': redefinition
*** ERROR C231 IN LINE 248 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'F1': redefinition
*** ERROR C231 IN LINE 249 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'OV': redefinition
*** ERROR C231 IN LINE 250 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'RS0': redefinition
*** ERROR C231 IN LINE 251 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'RS1': redefinition
*** ERROR C231 IN LINE 252 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'F0': redefinition
*** ERROR C231 IN LINE 253 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'AC': redefinition
C51 COMPILER V9.01   INIT_TIME2                                                            05/29/2011 16:28:04 PAGE 3   

*** ERROR C231 IN LINE 254 OF C:\KEIL\C51\INC\ATMEL\AT89X52.H: 'CY': redefinition
*** WARNING C322 IN LINE 174 OF typedef.h: unknown identifier
*** ERROR C221 IN LINE 272 OF TYPEDEF.H: non-constant case/dim expression
*** ERROR C129 IN LINE 282 OF TYPEDEF.H: missing ';' before 'code'
*** ERROR C301 IN LINE 4 OF 24c3264.h: identifier expected
*** WARNING C317 IN LINE 144 OF THANHSONCHIP.H: attempt to redefine macro 'POF_'
*** WARNING C317 IN LINE 149 OF THANHSONCHIP.H: attempt to redefine macro 'disale_'
*** WARNING C317 IN LINE 150 OF THANHSONCHIP.H: attempt to redefine macro 'disrto_'
*** WARNING C317 IN LINE 151 OF THANHSONCHIP.H: attempt to redefine macro 'wdidle_'
*** WARNING C322 IN LINE 16 OF delay.h: unknown identifier
*** WARNING C315 IN LINE 9 OF digi2text.h: unknown #directive 'endifs'
*** WARNING C317 IN LINE 8 OF checktimeout.h: attempt to redefine macro 'adee_env'
   3          #include  <typedef.h >
   4          #include  <init_time2.h>
   5          
   6          void ouputtime2f(unsigned long f)////HAM NAY CHUAN 
   7          {
   8            TR2=0;
   9            TCLK=0;RCLK=0;//2 bit nay phai bang 0 neu ko phai tao baut
  10            T2MOD|=T2OE_; //set che do ouput xung
  11            C_T2=0;//dat che do time ko fai dem
  12            EXEN2=0;//bo chan ngat reload T2EX
  13          
  14            RCAP2L=-(unsigned int)(xtal/4/f);
  15            RCAP2H=(-(unsigned int)(xtal/4/f))>>8;
  16            TR2=1;
  17           // ET2=0; neu muon ngat ngoai thi cho bit nay bang 1
  18          }
  19          unsigned int  t2capture() //HAM NAY CHUAN 
  20          {
  21            TR2=0;
  22            TCLK=0;RCLK=0;//2 bit nay phai bang 0 neu ko phai tao baut
  23            T2MOD&=(~T2OE_); //bo che do ouput neu da cai
  24            
  25            C_T2=0;//lay xung trong dem thoi gian
  26            EXEN2=1;//se load bo dem vao rcap2 khi co ngat 1-0 tai T2EX dong thoi tao ngat EXF2
  27            //co ngat xay ra ta vao doc gia tri rcap2 chinh la so xung dem dc ke tu luc set
  28            while(!T2EX);//bat dau co tin hieu thi set cho tr2 chay
  29            TR2=1;
  30            while(!EXF2);
  31            return (RCAP2L+(unsigned int)RCAP2H<<8);
  32          }
  33          void t2autoreload()   //HAM NAY CHUAN 
  34          {
  35              TR2=0;
  36              TCLK=0;RCLK=0;//2 bit nay phai bang 0 neu ko phai tao baut
  37                          T2MOD&=(~T2OE_); //bo nap ra t2, bo che do tu nap lai dcen-0( o anh huong chan ngoai)
  38              T2MOD&=(~DCEN_); // =0 dem tang
  39              EXEN2=0;//bo chan ngat reload T2EX
  40          
  41                          RCAP2L=-(us2cyclesl(50000));//thay 50000 bang so chu ky may mong muon
  42                          RCAP2H=(-(us2cyclesl(50000)))>>8;
  43                                  
  44                          ET2=1;// cho ngat time 2
  45                          
  46                          PT2=0; //dat uu tien
  47          
  48                          TR2=1;
  49           }
  50          void t2baud(unsigned int baud)////HAM NAY CHUAN 
  51          {
  52              TR2=0;
C51 COMPILER V9.01   INIT_TIME2                                                            05/29/2011 16:28:04 PAGE 4   

  53              TCLK=1;RCLK=1;//ca thu phat uart dung time 2 tao baut cac che do khac se tu ko hoat dong
  54                  /*      T2MOD&=T2OE_; //bo nap ra t2, bo che do tu nap lai dcen-0( o anh huong chan ngoai)
  55              T2MOD&=DCEN_; // =0 dem tang*/ //ko quan tam may thu nay do
  56              EXEN2=0;//bo chan ngat reload T2EX neu dat bang 1 thi co ngat nhung cung ko bi reload
  57              C_T2=0; //bat buoc clear bit nay bao cho dung time
  58                          RCAP2L=-xtal/32/baud;
  59                          RCAP2H=-xtal/32/baud>>8;
  60                                  
  61                          ET2=1;//
  62                          
  63                          TR2=1;
  64           }
  65           
  66           void com_init (unsigned int baud) { // dung time1 //HAM NAY CHUAN 
  67                    // Configure timer 1 as a baud rate generator
  68            TCLK=0;RCLK=0;//tao baud thu fat deu dung time 1 mac dinh la 00 luon
  69            PCON |= SMOD_;                                 // 0x80=SMOD: set serial baudrate doubler
  70          
  71            TMOD = T1_M0_&(~T1_M1_)&(~T1_CT_)&(~T1_GATE_);//tuong duong lenh duoi, lenh nay ro hon ve cau truc fan c
             -ung
  72            TMOD |= 0x20;                                  // put timer 1 into MODE 2
  73            
  74            TH1 = (unsigned char) (256 - (xtal / (16L * 12L * baud)));
  75            TR1 = 1;                              // start timer 1
  76            //khoi lenh nay tuong duong lenh duoi nhung ro net hon
  77           {
  78            RI   = 1;//set khi co ngat thu phai set de co the thu dc ban dau
  79            TI   = 1;//set khi co ngat phat phai set de co the phat duoc ban dau
  80            RB8  = 0;//ko cho thu bit 8 chi set khi multi
  81            TB8  = 0;//ko cho truyen bit 8 chi set khi multi
  82            REN  = 1;//cho phep thu
  83            SM2  = 0;//ko phai che do multy
  84            SM1  = 1;
  85            SM0  = 0;  
  86           }
  87            SCON = 0x53;    // serial port MODE 1, enable serial receiver
  88            PS=1;//uu tien ngat noi tiep do co che do thu ngay nhien
  89            ET1=0;//ko ngat time 1 mac dinh la vay
  90            ES = 1;                               // enable serial interrupts
  91          }
  92          
  93          
*** WARNING C316 IN LINE 93 OF init_time2.c: unterminated conditionals

C51 COMPILATION COMPLETE.  13 WARNING(S),  115 ERROR(S)
